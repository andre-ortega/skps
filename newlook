#!/usr/bin/env bash

set -eou pipefail

# LOAD SAVE
#wall=sara_white.png
#wall=graffiti

WALL_DIR=/home/roe/pix/wall

# Prioritize command-line arg
if  [[ $# -eq 1 ]]; then
  wall=$1
# If no save, randomize
elif [ -z ${wall+x} ]; then
  wall=$WALL_DIR/$(ls -1 ~/pix/wall/ | shuf -n 1)
# Else execute save
else
  wall=$WALL_DIR/$wall
fi

# Add this as background wallpaper
xwallpaper --zoom $wall

# Clear
wal -c

# Generate color scheme 
if [[ $wall =~ "clearing" ]]; then
  wal -a 92 --theme custom-clearing
elif [[ $wall =~ "city" ]]; then
  wal -a 92 --theme custom-city
elif [[ $wall =~ "rocket" ]]; then
  wal -a 92 --theme custom-rocket
elif [[ $wall =~ "farfaraway" ]]; then
  wal -a 92 --theme custom-farfaraway
elif [[ $wall =~ "alpine3" ]]; then
  wal -a 92 --theme custom-alpine3
elif [[ $wall =~ "keebz" ]]; then
  wal -a 92 --theme custom-keebz
elif [[ $wall =~ "kohakunushi" ]]; then
  wal -a 92 --theme custom-kohakunushi
elif [[ $wall =~ "dystopia" ]]; then
  wal -a 92 --theme custom-dystopia
elif [[ $wall =~ "graffiti" ]]; then
  wal -a 92 -f $HOME/skps/custom_walz/custom-graffiti.json
elif [[ $wall =~ "road_through_desert" ]]; then
  wal -a 92 --theme custom-road-through-desert
elif [[ $wall =~ "koi" ]]; then
  wal -a 92 --theme custom-koi
elif [[ $wall =~ "breathe" ]]; then
  wal -a 92 -f $HOME/skps/custom_walz/custom-breathe.json
elif [[ $wall =~ "orbits" ]]; then
  wal -a 92 --theme custom-orbits
elif [[ $wall =~ "sara_android" ]]; then
  wal -a 92 --theme custom-sara_android
elif [[ $wall =~ "sara_white" ]]; then
  wal -a 92 --theme custom-sara_white
elif [[ $wall =~ "embroidery" ]]; then
  wal -a 92 -f $HOME/skps/custom_walz/custom-embroidery.json
elif [[ $wall =~ "sara_katana" ]]; then
  wal -a 92 --theme custom-sara_katana
elif [[ $wall =~ "sara_grayscale" ]]; then
  wal -a 92 --theme custom-sara_grayscale
else
  wal -a 92 -i $wall
fi

if [[ ! -z $(pgrep polybar) ]]; then
  killall -9 polybar
  sleep 1;
fi

MONITOR=eDP-1 polybar center --config=$HOME/.config/polybar/config.ini &
MONITOR=HDMI-1 polybar secondary-center --config=$HOME/.config/polybar/config.ini &
